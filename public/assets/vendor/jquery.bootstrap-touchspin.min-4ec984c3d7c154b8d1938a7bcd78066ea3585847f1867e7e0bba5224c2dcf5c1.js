!function(o){"function"==typeof define&&define.amd?define(["jquery"],o):"object"==typeof module&&module.exports?module.exports=function(t,n){return void 0===n&&(n="undefined"!=typeof window?require("jquery"):require("jquery")(t)),o(n),n}:o(jQuery)}(function(j){"use strict";var D=0;j.fn.TouchSpin=function(y){var k={min:0,max:100,initval:"",replacementval:"",step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:!1,verticalup:"+",verticaldown:"-",verticalupclass:"",verticaldownclass:"",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-primary",buttonup_class:"btn btn-primary",buttondown_txt:"-",buttonup_txt:"+",callback_before_calculation:function(t){return t},callback_after_calculation:function(t){return t}},C={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each(function(){function a(){""===d.prefix&&(f=v.prefix.detach()),""===d.postfix&&(b=v.postfix.detach())}function e(){var t,n,o;""!==(t=d.callback_before_calculation(g.val()))?0<d.decimals&&"."===t||(n=parseFloat(t),isNaN(n)&&(n=""!==d.replacementval?d.replacementval:0),(o=n).toString()!==t&&(o=n),null!==d.min&&n<d.min&&(o=d.min),null!==d.max&&n>d.max&&(o=d.max),o=function(t){switch(d.forcestepdivisibility){case"round":return(Math.round(t/d.step)*d.step).toFixed(d.decimals);case"floor":return(Math.floor(t/d.step)*d.step).toFixed(d.decimals);case"ceil":return(Math.ceil(t/d.step)*d.step).toFixed(d.decimals);default:return t}}(o),Number(t).toString()!==o.toString()&&(g.val(o),g.trigger("change"))):""!==d.replacementval&&(g.val(d.replacementval),g.trigger("change"))}function o(){if(d.booster){var t=Math.pow(2,Math.floor(w/d.boostat))*d.step;return d.maxboostedstep&&t>d.maxboostedstep&&(t=d.maxboostedstep,s=Math.round(s/t)*t),Math.max(d.step,t)}return d.step}function i(){e(),s=parseFloat(d.callback_before_calculation(v.input.val())),isNaN(s)&&(s=0);var t=s,n=o();s+=n,null!==d.max&&s>d.max&&(s=d.max,g.trigger("touchspin.on.max"),l()),v.input.val(d.callback_after_calculation(Number(s).toFixed(d.decimals))),t!==s&&g.trigger("change")}function u(){e(),s=parseFloat(d.callback_before_calculation(v.input.val())),isNaN(s)&&(s=0);var t=s,n=o();s-=n,null!==d.min&&s<d.min&&(s=d.min,g.trigger("touchspin.on.min"),l()),v.input.val(d.callback_after_calculation(Number(s).toFixed(d.decimals))),t!==s&&g.trigger("change")}function r(){l(),w=0,_="down",g.trigger("touchspin.on.startspin"),g.trigger("touchspin.on.startdownspin"),p=setTimeout(function(){t=setInterval(function(){w++,u()},d.stepinterval)},d.stepintervaldelay)}function c(){l(),w=0,_="up",g.trigger("touchspin.on.startspin"),g.trigger("touchspin.on.startupspin"),x=setTimeout(function(){n=setInterval(function(){w++,i()},d.stepinterval)},d.stepintervaldelay)}function l(){switch(clearTimeout(p),clearTimeout(x),clearInterval(t),clearInterval(n),_){case"up":g.trigger("touchspin.on.stopupspin"),g.trigger("touchspin.on.stopspin");break;case"down":g.trigger("touchspin.on.stopdownspin"),g.trigger("touchspin.on.stopspin")}w=0,_=!1}var d,f,b,h,v,s,t,n,p,x,g=j(this),m=g.data(),w=0,_=!1;!function(){var t,n,o,s,p;if(!g.data("alreadyinitialized"))g.data("alreadyinitialized",!0),D+=1,g.data("spinnerid",D),g.is("input")?(""!==(d=j.extend({},k,m,(p={},j.each(C,function(t,n){var o="bts-"+n;g.is("[data-"+o+"]")&&(p[t]=g.data(o))}),p),y)).initval&&""===g.val()&&g.val(d.initval),e(),o=g.val(),s=g.parent(),""!==o&&(o=d.callback_after_calculation(Number(o).toFixed(d.decimals))),g.data("initvalue",o).val(o),g.addClass("form-control"),s.hasClass("input-group")?function(t){t.addClass("bootstrap-touchspin");var n,o,s=g.prev(),p=g.next(),a='<span class="input-group-addon input-group-prepend bootstrap-touchspin-prefix input-group-prepend bootstrap-touchspin-injected"><span class="input-group-text">'+d.prefix+"</span></span>",e='<span class="input-group-addon input-group-append bootstrap-touchspin-postfix input-group-append bootstrap-touchspin-injected"><span class="input-group-text">'+d.postfix+"</span></span>";s.hasClass("input-group-btn")||s.hasClass("input-group-prepend")?(n='<button class="'+d.buttondown_class+' bootstrap-touchspin-down bootstrap-touchspin-injected" type="button">'+d.buttondown_txt+"</button>",s.append(n)):(n='<span class="input-group-btn input-group-prepend bootstrap-touchspin-injected"><button class="'+d.buttondown_class+' bootstrap-touchspin-down" type="button">'+d.buttondown_txt+"</button></span>",j(n).insertBefore(g)),p.hasClass("input-group-btn")||p.hasClass("input-group-append")?(o='<button class="'+d.buttonup_class+' bootstrap-touchspin-up bootstrap-touchspin-injected" type="button">'+d.buttonup_txt+"</button>",p.prepend(o)):(o='<span class="input-group-btn input-group-append bootstrap-touchspin-injected"><button class="'+d.buttonup_class+' bootstrap-touchspin-up" type="button">'+d.buttonup_txt+"</button></span>",j(o).insertAfter(g)),j(a).insertBefore(g),j(e).insertAfter(g),h=t}(s):(n="",g.hasClass("input-sm")&&(n="input-group-sm"),g.hasClass("input-lg")&&(n="input-group-lg"),t=d.verticalbuttons?'<div class="input-group '+n+' bootstrap-touchspin bootstrap-touchspin-injected"><span class="input-group-addon input-group-prepend bootstrap-touchspin-prefix"><span class="input-group-text">'+d.prefix+'</span></span><span class="input-group-addon bootstrap-touchspin-postfix input-group-append"><span class="input-group-text">'+d.postfix+'</span></span><span class="input-group-btn-vertical"><button class="'+d.buttondown_class+" bootstrap-touchspin-up "+d.verticalupclass+'" type="button">'+d.verticalup+'</button><button class="'+d.buttonup_class+" bootstrap-touchspin-down "+d.verticaldownclass+'" type="button">'+d.verticaldown+"</button></span></div>":'<div class="input-group bootstrap-touchspin bootstrap-touchspin-injected"><span class="input-group-btn input-group-prepend"><button class="'+d.buttondown_class+' bootstrap-touchspin-down" type="button">'+d.buttondown_txt+'</button></span><span class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"><span class="input-group-text">'+d.prefix+'</span></span><span class="input-group-addon bootstrap-touchspin-postfix input-group-append"><span class="input-group-text">'+d.postfix+'</span></span><span class="input-group-btn input-group-append"><button class="'+d.buttonup_class+' bootstrap-touchspin-up" type="button">'+d.buttonup_txt+"</button></span></div>",h=j(t).insertBefore(g),j(".bootstrap-touchspin-prefix",h).after(g),g.hasClass("input-sm")?h.addClass("input-group-sm"):g.hasClass("input-lg")&&h.addClass("input-group-lg")),v={down:j(".bootstrap-touchspin-down",h),up:j(".bootstrap-touchspin-up",h),input:j("input",h),prefix:j(".bootstrap-touchspin-prefix",h).addClass(d.prefix_extraclass),postfix:j(".bootstrap-touchspin-postfix",h).addClass(d.postfix_extraclass)},a(),g.on("keydown.touchspin",function(t){var n=t.keyCode||t.which;38===n?("up"!==_&&(i(),c()),t.preventDefault()):40===n&&("down"!==_&&(u(),r()),t.preventDefault())}),g.on("keyup.touchspin",function(t){var n=t.keyCode||t.which;38===n?l():40===n&&l()}),g.on("blur.touchspin",function(){e(),g.val(d.callback_after_calculation(g.val()))}),v.down.on("keydown",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||("down"!==_&&(u(),r()),t.preventDefault())}),v.down.on("keyup.touchspin",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||l()}),v.up.on("keydown.touchspin",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||("up"!==_&&(i(),c()),t.preventDefault())}),v.up.on("keyup.touchspin",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||l()}),v.down.on("mousedown.touchspin",function(t){v.down.off("touchstart.touchspin"),g.is(":disabled")||(u(),r(),t.preventDefault(),t.stopPropagation())}),v.down.on("touchstart.touchspin",function(t){v.down.off("mousedown.touchspin"),g.is(":disabled")||(u(),r(),t.preventDefault(),t.stopPropagation())}),v.up.on("mousedown.touchspin",function(t){v.up.off("touchstart.touchspin"),g.is(":disabled")||(i(),c(),t.preventDefault(),t.stopPropagation())}),v.up.on("touchstart.touchspin",function(t){v.up.off("mousedown.touchspin"),g.is(":disabled")||(i(),c(),t.preventDefault(),t.stopPropagation())}),v.up.on("mouseup.touchspin mouseout.touchspin touchleave.touchspin touchend.touchspin touchcancel.touchspin",function(t){_&&(t.stopPropagation(),l())}),v.down.on("mouseup.touchspin mouseout.touchspin touchleave.touchspin touchend.touchspin touchcancel.touchspin",function(t){_&&(t.stopPropagation(),l())}),v.down.on("mousemove.touchspin touchmove.touchspin",function(t){_&&(t.stopPropagation(),t.preventDefault())}),v.up.on("mousemove.touchspin touchmove.touchspin",function(t){_&&(t.stopPropagation(),t.preventDefault())}),g.on("mousewheel.touchspin DOMMouseScroll.touchspin",function(t){if(d.mousewheel&&g.is(":focus")){var n=t.originalEvent.wheelDelta||-t.originalEvent.deltaY||-t.originalEvent.detail;t.stopPropagation(),t.preventDefault(),n<0?u():i()}}),g.on("touchspin.destroy",function(){var t;t=g.parent(),l(),g.off(".touchspin"),t.hasClass("bootstrap-touchspin-injected")?(g.siblings().remove(),g.unwrap()):(j(".bootstrap-touchspin-injected",t).remove(),t.removeClass("bootstrap-touchspin")),g.data("alreadyinitialized",!1)}),g.on("touchspin.uponce",function(){l(),i()}),g.on("touchspin.downonce",function(){l(),u()}),g.on("touchspin.startupspin",function(){c()}),g.on("touchspin.startdownspin",function(){r()}),g.on("touchspin.stopspin",function(){l()}),g.on("touchspin.updatesettings",function(t,n){!function(){(function(t){(d=j.extend({},d,t),t.postfix)&&(0===g.parent().find(".bootstrap-touchspin-postfix").length&&b.insertAfter(g),g.parent().find(".bootstrap-touchspin-postfix .input-group-text").text(t.postfix));t.prefix&&(0===g.parent().find(".bootstrap-touchspin-prefix").length&&f.insertBefore(g),g.parent().find(".bootstrap-touchspin-prefix .input-group-text").text(t.prefix));a()})(n),e();var t=v.input.val();""!==t&&(t=Number(d.callback_before_calculation(v.input.val())),v.input.val(d.callback_after_calculation(Number(t).toFixed(d.decimals))))}()})):console.log("Must be an input.")}()})}});